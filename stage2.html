<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>1.38 stage.html - 30件データと拡張デバッグツールの統合</title>
    <style>
        :root {
            --jiji-blue: #007AFF;
            --center-white: #FFFFFF;
            --kaito-yellow: #FFD700;
        }
        body { background-color: #1a1a1a; color: white; font-family: sans-serif; display: flex; margin: 0; padding: 20px; overflow-x: auto; }
        
        /* iPhone Stage (Ver 1.37基盤) */
        #iphone-frame {
            width: 375px; height: 812px; background: black; border-radius: 40px;
            position: relative; overflow: hidden; flex-shrink: 0; border: 8px solid #333;
        }
        .layer { width: 100%; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        #jiji-layer { height: 25%; background: var(--jiji-blue); }
        #center-layer { height: 50%; background: var(--center-white); color: black; padding: 20px; box-sizing: border-box; text-align: center; }
        #kaito-layer { height: 25%; background: var(--kaito-yellow); color: black; }

        /* 楽屋 (Debug Tool) - iPhoneの外側に配置 */
        #debug-area { margin-left: 30px; min-width: 400px; display: none; font-family: monospace; }
        .panel { background: #222; border-left: 4px solid var(--jiji-blue); margin-bottom: 15px; padding: 10px; }
        .panel-title { font-size: 14px; font-weight: bold; margin-bottom: 8px; color: var(--jiji-blue); }
        
        table { width: 100%; border-collapse: collapse; font-size: 10px; } /* 極限までフォントを下げて網羅 */
        th, td { border: 1px solid #444; padding: 2px 4px; text-align: center; }
        th { background: #333; color: #aaa; }
        .word-cell { text-align: left; color: #4cd137; }
    </style>
</head>
<body>

    <div id="iphone-frame">
        <div id="jiji-layer" class="layer">じじ（青）</div>
        <div id="center-layer" class="layer">
            <div>しりとり、はじめよう。<br>じじからどうぞ</div>
        </div>
        <div id="kaito-layer" class="layer">凱士（黄）</div>
    </div>

    <div id="debug-area">
        <div style="font-size: 12px; color: #666; margin-bottom: 10px;">1.38 stage.html / iPad mini Debug Mode</div>
        
        <div class="panel">
            <div class="panel-title">mainMaster (進捗管理)</div>
            <table id="master-table">
                <thead><tr><th>A</th><th>B</th><th>No</th><th>頭</th><th>尻</th><th>単語</th></tr></thead>
                <tbody id="master-body"></tbody>
            </table>
        </div>

        <div class="panel">
            <div class="panel-title">workFiles (特設ステージ: 上5 / 下5)</div>
            <table id="work-table">
                <thead><tr><th>A</th><th>B</th><th>No</th><th>頭</th><th>尻</th><th>単語</th></tr></thead>
                <tbody id="work-body"></tbody>
            </table>
        </div>
    </div>

    <script>
        // --- 設定 ---
        const IS_DEBUG = true;

        // じじ指定の30件データ (Ver 1.63 test-logic 準拠)
        const wordList = ["りんご","ごりら","らっぱ","ぱせり","りす","すいか","かめ","めだか","からす","すべりだい","いか","かさ","さかな","なす","すぽーつ","つくえ","えりまき","きつね","ねこ","こあら","らくがき","きゅうきゅうしゃ","あひる","るびー","いぬ","ぬいぐるみ","みみ","みず","すなば","はとり"];

        // データ構造の展開
        const MASTER_DATA = wordList.map((w, i) => ({
            flagA: 0,
            flagB: 0,
            no: i + 1,
            head: w[0],
            tail: w[w.length - 1],
            word: w
        }));

        const app = {
            mainMaster: MASTER_DATA,
            workFiles: [...MASTER_DATA], // 初期はコピー

            init() {
                if (IS_DEBUG) {
                    document.getElementById('debug-area').style.display = 'block';
                    this.renderDebug();
                }
            },

            renderDebug() {
                const createRow = d => `
                    <tr>
                        <td>${d.flagA}</td>
                        <td>${d.flagB}</td>
                        <td>${d.no}</td>
                        <td>${d.head}</td>
                        <td>${d.tail}</td>
                        <td class="word-cell">${d.word}</td>
                    </tr>`;

                // mainMaster (10件程度を抜粋表示)
                document.getElementById('master-body').innerHTML = 
                    this.mainMaster.slice(0, 10).map(createRow).join('') + 
                    `<tr><td colspan="6" style="color:#666">... (全30件)</td></tr>`;

                // workFiles (上5件・下5件)
                const top5 = this.workFiles.slice(0, 5);
                const last5 = this.workFiles.slice(-5);
                document.getElementById('work-body').innerHTML = 
                    top5.map(createRow).join('') + 
                    `<tr><td colspan="6" style="background:#111; color:#444">--- 中略 ---</td></tr>` +
                    last5.map(createRow).join('');
            }
        };

        window.onload = () => app.init();
    </script>
</body>
</html>
